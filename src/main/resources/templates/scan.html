<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자세 인식중</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/css/style.css">
</head>
<style>
    .gallery button a {
        color: inherit;  /* 버튼의 텍스트 색상을 상속받음 */
        text-decoration: none;  /* 텍스트 밑줄 제거 */
    }

    @font-face {
        font-family: 'NIXGONM-Vb';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_six@1.2/NIXGONM-Vb.woff') format('woff');
        font-weight: normal;
        font-style: normal;
    }

    * {
        font-family: 'NIXGONM-Vb';
    }

    a {
        color: #6e6e6e;
        text-decoration: none;
    }

    a:hover {
        color: #6e6e6e;
        text-decoration: none;
    }

    :root {
        font-size: 10px;
    }

    .container {
        max-width: 110.5rem;
        margin: 0 auto;
        padding: 0 2rem;
    }

    @supports (display: grid) {
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(22rem, 1fr));
            grid-gap: 2rem;
        }
    }

    .message2 p {
        margin-top: 200px;
        font-weight: 400;
        color: #6D6E85;
        text-decoration: none;
        font-size: 40px;
        text-align: center;
        letter-spacing: -2px;
    }

    .form button a {
        font-family: 'NIXGONM-Vb';
        font-weight: 500;
        color: #515264;
        text-decoration: none;
        font-size: 37px;
        text-align: center;
        letter-spacing: 1px;
    }

    header {
        background-color: #33343f;
        color: white;
        padding: 20px;
        border-bottom: 3px solid #2D8DB6;
    }

    footer {
        background-color: #33343f;
        color: white;
        padding: 20px;
        text-align: center;
    }

    .black-section {
        background-color: #33343f; /* 검정색 배경 */
        height: 500px; /* 높이 지정, 필요에 따라 조정 */
    }

    .username-color {
        color: #15c6e5;
    }
</style>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<body style="background-color: #FFFBF5;">
<main>

    <header class="p-3">
        <div class="container d-flex justify-content-between align-items-center">
            <img src="/assets/img/logo3.png" width="155" height="40" alt="Logo">
            <div><span id="username" class="me-2">
    <span class="username-color">[[${userName}]]</span>님, 환영합니다!
    </span>
                <a role="button" id="login" class="btn btn-outline-light me-2">Edit</a>
                <a role="button" id="logout" class="btn btn-outline-light me-2">Logout</a>
            </div>
        </div>
    </header>

    <div class="container" style="padding-top: 1%">
        <h1 style="text-align: center; color: #6D6E85; padding-top: 5%;">자세 체크 중...</h1>
        <h1 style="text-align: center; color: #5e5f73;"><strong>당신의 자세를 분석 중입니다.</strong></h1><br><br><br><br>

        <div id="webcam-container" style="display: none; justify-content: center; align-items: center; margin-left: 20.5%" >
            <video id="webcam" width="640" height="480" autoplay></video>
        </div>

        <div id="dictate-container" style="padding-left: 38%">
            <button class="dictate" style="width: 38%; height: 75%; border-radius: 100%; border: none; background-color: #6D6E85;">
                <i class="ic-mike"></i>
                <svg width="9.25rem" height="23.25rem" viewBox="0 0 100 100">
                    <g stroke="#fff" stroke-width="15">
                        <path d="M50,50 50,130">
                            <animate attributeName="d" values="M20,40 20,60;M20,20 20,80;M20,40 20,60" dur="1s" repeatCount="indefinite" />
                        </path>
                        <path d="M100,60 100,140">
                            <animate attributeName="d" values="M50,10 50,90;M50,40 50,60;M50,10 50,90" dur="1s" repeatCount="indefinite" />
                        </path>
                        <path d="M50,50 50,130">
                            <animate attributeName="d" values="M80,40 80,60;M80,20 80,80;M80,40 80,60" dur="1s" repeatCount="indefinite" />
                        </path>
                    </g>
                </svg>
            </button>
        </div>

        <div class="gallery" style="padding-top: 25%; padding-left: 24%">
            <button id="toggle-cam" style="background-color: #cbcbcb; color: #656565; font-size: 22px; width: 36%; border: none;height: 60px; border-radius: 50px; padding: 3px 2px; position: relative; top: -160px; box-shadow: 6px 6px 6px #C2C2C2; margin-bottom: 20px;"><strong>캠 표시하기</strong></button>
            <button type="submit" style="background-color: #cbcbcb; color: #656565; font-size: 22px; border: none; width: 36%; height: 60px; border-radius: 50px; padding: 3px 2px; position: relative; top: -160px; box-shadow: 6px 6px 6px #C2C2C2; margin-bottom: 20px;"><a href="/main"><strong>종료</strong></a></button>
        </div>
    </div>
</main>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $(document).ready(function() {
        $('.message a').click(function() {
            $('form').animate({
                height: "toggle",
                opacity: "toggle"
            }, "slow");
        });
    });

    const webcamContainer = document.getElementById('webcam-container');
    const dictateContainer = document.getElementById('dictate-container');
    const webcam = document.getElementById('webcam');
    const toggleCamBtn = document.getElementById('toggle-cam');

    let webcamActive = false;

    toggleCamBtn.addEventListener('click', () => {
        if (webcamActive) {
            const tracks = webcam.srcObject.getTracks();
            tracks.forEach(track => track.stop());
            webcam.srcObject = null;
            webcamContainer.style.display = 'none';
            dictateContainer.style.display = 'block';
            toggleCamBtn.innerText = '캠 표시하기';
            webcamActive = false;
        } else {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(stream => {
                    webcam.srcObject = stream;
                    webcamContainer.style.display = 'block';
                    dictateContainer.style.display = 'none';
                    toggleCamBtn.innerText = '캠 숨기기';
                    webcamActive = true;
                })
                .catch(error => console.error('Error accessing webcam:', error));
        }
    });
</script>
<footer>
    <p>OpenCV를 활용한 거북목 개선 프로젝트</p>
    <a href="#" class="text-light">메인페이지로</a>
</footer>
<div class="black-section"></div>
</body>
</html>