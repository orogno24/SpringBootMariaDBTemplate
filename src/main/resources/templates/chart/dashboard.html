<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>통계</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css"
          href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/css/dashboard.css">

    <style type="text/css">
    </style>
</head>

<body>

<ul id="slide-out" class="side-nav fixed z-depth-2" style="background-color: #2D2F36">
    <li class="center no-padding">
        <div class="indigo darken-2 white-text" style="height: 180px; background-color: #15c6e5">
            <div class="row" style="background: #33343f">
                <img style="margin-top: 10%;" width="75" height="75" src="/assets/img/logo7.png"/>

                <p style="margin-top: -13%;">
                    <span style="color: #15c6e5">[[${userName}]]</span>님의 페이지
                </p>
            </div>
        </div>
    </li>

    <li id="dash_dashboard"><a class="waves-effect" href="/main"><b>메인페이지로</b></a></li>
    <li id="dash_dashboard2"><a class="waves-effect" href="/guide2"><b>메인페이지로</b></a></li>
    <li id="dash_dashboard3"><a class="waves-effect" href="/main"><b>메인페이지로</b></a></li>

    <ul class="collapsible" data-collapsible="accordion">


        <li id="dash_products">
            <div id="dash_products_header" class="collapsible-header waves-effect"><b>지도</b></div>
            <div id="dash_products_body" class="collapsible-body">
                <ul>
                    <li id="products_product">
                        <a class="waves-effect" style="text-decoration: none;" href="#!">Products</a>
                        <a class="waves-effect" style="text-decoration: none;" href="#!">Orders</a>
                    </li>
                </ul>
            </div>
        </li>

        <li id="dash_categories">
            <div id="dash_categories_header" class="collapsible-header waves-effect"><b>커뮤니티</b></div>
            <div id="dash_categories_body" class="collapsible-body">
                <ul>
                    <li id="categories_category">
                        <a class="waves-effect" style="text-decoration: none;" href="#!">Category</a>
                    </li>

                    <li id="categories_sub_category">
                        <a class="waves-effect" style="text-decoration: none;" href="#!">Sub Category</a>
                    </li>
                </ul>
            </div>
        </li>
    </ul>
</ul>

<header>
    <ul class="dropdown-content" id="user_dropdown">
        <li><a class="indigo-text" href="#!">Profile</a></li>
        <li><a class="indigo-text" href="#!">Logout</a></li>
    </ul>

    <nav class="indigo" role="navigation">
        <div class="nav-wrapper">
            <img style="margin-top: 17px; margin-left: 5px;" src="/assets/img/chart.png"/>

            <ul class="right hide-on-med-and-down">
                <li>
                    <a class='right dropdown-button' href='' data-activates='user_dropdown'><i class=' material-icons'>account_circle</i></a>
                </li>
            </ul>

            <a href="#" data-activates="slide-out" class="button-collapse"><i class="mdi-navigation-menu"></i></a>
        </div>
    </nav>

    <nav>
        <div class="nav-wrapper indigo darken-3">
            <span style="color:#b2b2b2;">&nbsp;&nbsp;현재 페이지에서 당신의 통계를 확인할 수 있습니다.</span>
            <div style="margin-right: 20px;" id="timestamp" class="right"></div>
        </div>
    </nav>
</header>

<main>
    <div class="row">
        <div class="col s6">
            <div style="padding: 35px; min-height: 352px; overflow: auto; background-color: #fdfdfd;" align="center"
                 class="card">
                <div class="row">
                    <div class="left card-title">
                        <b style="color: #2b2b36; font-size: 24px; border-bottom: 2px solid #a8001d; display: inline-block; padding-bottom: 5px;">오늘의
                            자세 점수</b>
                    </div>
                </div>

                <img src="/assets/img/bg3.png" alt="Posture Icon" style="height: 160px; margin-bottom: -30px">

                <div class="score">
                    <p style="font-size: 50px; font-weight: bold; color: #333;">[[${userName}]]님의 자세 점수: <span
                            style="color: #a8001d;">85</span>점</p>
                </div>

                <p style="font-size: 20px; margin-top: 20px; color: #555;">
                    잘 하고 있어요! 조금만 더 주의를 기울이면 완벽한 자세를 유지할 수 있을 거예요.
                </p>
            </div>
        </div>

        <div class="col s6">
            <div style="padding: 35px; min-height: 352px; overflow: auto; background-color: #fdfdfd;" align="center"
                 class="card">
                <div class="row">
                    <div class="left card-title">
                        <b style="color: #2b2b36; font-size: 24px; border-bottom: 2px solid #a8001d; display: inline-block; padding-bottom: 5px;">사용자 평균 점수</b>
                    </div>
                </div>

                <img src="/assets/img/turtle.png" alt="Posture Icon" style="height: 160px; margin-bottom: -30px">

                <div class="score">
                    <p style="font-size: 50px; font-weight: bold; color: #333;">사용자 평균 점수: <span
                            style="color: #a8001d;">56</span>점</p>
                </div>

                <p style="font-size: 20px; margin-top: 20px; color: #555;">
                    전체 사용자들의 평균 자세 점수와 비교할 수 있습니다.
                </p>

            </div>
        </div>
    </div>

    <div class="row">
        <div class="col s6">
            <div style="padding: 35px;" align="center" class="card">
                <div class="row">
                    <div class="left card-title">
                        <b style="color: #2b2b36; font-size: 24px; border-bottom: 2px solid #a8001d; display: inline-block; padding-bottom: 5px;">
                            정상/비정상 자세 비율 통계
                        </b>
                    </div>
                </div>
                <canvas class="pie-chart" id="pie">
                </canvas>
            </div>
        </div>

        <div class="col s6">
            <div style="padding: 35px;" align="center" class="card">
                <div class="row">
                    <div class="left card-title">
                        <b style="color: #2b2b36; font-size: 24px; border-bottom: 2px solid #a8001d; display: inline-block; padding-bottom: 5px;">
                            정상/비정상 자세 비율 전체 통계
                        </b>
                    </div>
                </div>
                <canvas class="pie-chart" id="pie2">
                </canvas>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col s6">
            <div style="padding: 35px;" align="center" class="card">
                <div class="row">
                    <div class="left card-title">
                        <b style="color: #2b2b36; font-size: 24px; border-bottom: 2px solid #a8001d; display: inline-block; padding-bottom: 5px;">
                            주간 사용 통계
                        </b>
                    </div>
                </div>
                <canvas id="postureChart">
                </canvas>
            </div>
        </div>

        <div class="col s6">
            <div style="padding: 35px;" align="center" class="card">
                <div class="row">
                    <div class="left card-title">
                        <b style="color: #2b2b36; font-size: 24px; border-bottom: 2px solid #a8001d; display: inline-block; padding-bottom: 5px;">
                            시간별 사용 통계
                        </b>
                    </div>
                </div>
                <div style="height: 85%">
                <canvas id="line">
                </canvas>
                </div>
            </div>
        </div>
    </div>

    <div class="fixed-action-btn click-to-toggle" style="bottom: 45px; right: 24px;">
        <a class="btn-floating btn-large pink waves-effect waves-light">
            <i class="large material-icons">add</i>
        </a>

        <ul>
            <li>
                <a class="btn-floating red"><i class="material-icons">note_add</i></a>
                <a href="" class="btn-floating fab-tip">Add a note</a>
            </li>

            <li>
                <a class="btn-floating yellow darken-1"><i class="material-icons">add_a_photo</i></a>
                <a href="" class="btn-floating fab-tip">Add a photo</a>
            </li>

            <li>
                <a class="btn-floating green"><i class="material-icons">alarm_add</i></a>
                <a href="" class="btn-floating fab-tip">Add an alarm</a>
            </li>

            <li>
                <a class="btn-floating blue"><i class="material-icons">vpn_key</i></a>
                <a href="" class="btn-floating fab-tip">Add a master password</a>
            </li>
        </ul>
    </div>
</main>

<footer class="indigo page-footer" style="margin-top: 30px">
    <div class="container">
    </div>
    <div class="footer-copyright">
    </div>
</footer>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        var maxHeight = 0;
        $('.card').each(function () {
            if ($(this).height() > maxHeight) {
                maxHeight = $(this).height();
            }
        }).height(maxHeight);
    });

    $(document).ready(function () {
        $('.button-collapse').sideNav();
        $('.collapsible').collapsible();
        $('select').material_select();
    });
</script>
<script th:inline="javascript">
    /*<![CDATA[*/
    const chartData = [[${chartData}]];
    /*]]>*/
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js">
</script>
<script>
    const totalNormal = [[${rDTO.totalNormal}]];
    const totalAbnormal = [[${rDTO.totalAbnormal}]];
    const labels = chartData.map(item => item.weekday);
    const normalData = chartData.map(item => item.totalNormal);
    const abnormalData = chartData.map(item => item.totalAbnormal);
</script>
<script type="text/javascript" src="/js/dashboard.js"></script>
</body>
</html>